{% extends 'base.html' %}
<!--even if you comment this out the system still recognizes it btw-->



{% block content %}
{% load static %}



<script src="http://malsup.github.com/jquery.form.js"></script>  

<h3>play template</h3>
<!--<div style="overflow: auto;background-color: lightblue;width: 800px;height: 1100px;">Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</div> -->
	<div id="mydiv" style="top:70px;left:805px;position: absolute;z-index: 9;background-color: #f1f1f1;text-align: center;border: 1px solid #d3d3d3;">
		<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
		<div id="mydivheader" style="cursor: move;padding: 10px;z-index: 10;background-color: #2196F3;color: #fff;">Click here to move</div>
		<p><button style="background-color: #e7e7e7;" onclick="useEmail(this)">Use1</button></p>
		<p><button style="background-color: #e7e7e7;">Delete</button></p>
		<p><input type="checkbox" id="triggerchb1" name="triggerchb" value="onn"></p>
		<div style="display:inline-block;background-color:rgb(250, 107, 94);cursor:pointer;" onclick="connectLine(this, 'red')">&#x2190;</div> <div style="display:inline-block;background-color: rgb(90, 243, 159);cursor:pointer;" onclick="connectLine(this, 'green')">&#x2192;</div>
		
	</div>   


	<div id="mydiv2" style="top:70px;left:405px;position: absolute;z-index: 9;background-color: #f1f1f1;text-align: center;border: 1px solid #d3d3d3;">
		<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
		<div id="mydiv2header" style="cursor: move;padding: 10px;z-index: 10;background-color: #2196F3;color: #fff;">Click here to move</div>
		<p><button onclick="connectLine(this, 'black')">Use</button></p>
		<p><button>Delete</button></p>
		<div style="display:inline-block;background-color: rgb(198, 198, 236);cursor:pointer;" onclick="connectLine(this, 'black')">&#x2192;</div>
		
	</div>   

	<!--remove the bottom link to stop affecting your already established bootstrap-->>
	<!--
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	-->
	<!-- include summernote css/js -->
	<!--
	<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>



	
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
-->
	<!--above added by iggy to make top nav bar stay put-->>


	<!-- include joinit css/js -->
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jodit/3.4.14/jodit.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/jodit/3.4.14/jodit.js"></script>



<div class=”n” id="emailContainer"  style="width:100%;height:100%;background-color: rgba(0,0,0,0.5);position: absolute;top:0px;z-index: 11;display: none;justify-content: center;align-items: center;">

</div>



<div class=”nm” id="myuseEmail" style="display: none;z-index: 12;position:absolute; border-style: outset;margin: auto;top:15%;right:30%;width:600px;height:auto;background-color: white;border-radius:15px;padding:5px;">
	<button style="float: right;background-color: red" onclick="removePopup(this)">X</button>
	<h1>Email Broadcast</h1>
	<div id="showoptions" style="background-color: #10b7c3;width:500px;height:50px"></div>

	<p><label>Name This Broadcast</label></p>
	<textarea id="emailNameOfBroadcast"></textarea>
	

	<p><label>Who Is It From?</label></p>
	<textarea id="emailWhoItFrom"></textarea>
	<button>Show Options</button>

	<p><label>Subject Line</label></p>
	<textarea id="emailSubjectLine"></textarea>

	<p><button id="emailDesignBroadcast" onclick="gotoEmailPage(this)" >Design Broadcast Email Content</button></p>

	<h2>Settings For Broadcast</h2>
	<input type="checkbox" id="emailOpenTracking" name="opentracking" value="openT">
	<label>Open Tracking</label>
	<input type="checkbox" id="emailClickTracking" name="clicktracking" value="clickT">
	<label>Click Tracking</label>
	<input type="checkbox" id="emailClickGoogleAnalytics" name="clickgoogleanalytics" value="clickGoogleAnalyticsT">
	<label>Track Click Using Google Analytics</label>
	<button style="float: right;" onclick="saveEmailPageOne(this)">Save<button></button>



</div>

<div id="myuseEmail2" style="display:none;z-index: 12;position:absolute; border-style: outset;margin: auto;top:15%;right:12%;width:1200px;height:auto;background-color: white;border-radius:15px;padding:5px;">
	<button style="float: right;background-color: red" onclick="removePopup2(this)">X</button>

	<h1>Design Email</h1>
	<!--
	<form method="post" >
	<textarea id="emailtextarea" >
	 </textarea>
	</form>
-->
	<textarea id="emailtextarea" ></textarea>
	
	<img src="static/img/copy and past in html editor.PNG" alt="Girl in a jacket" width="500" height="300">
	<button style="float: right;" onclick="saveEmailPageTwo(this)">Save<button>

</div>

<script>
	function saveEmailPageOne(element){
		//alert("hi");
		//alert(element.parentNode.getAttribute("data-idholder"));

		document.getElementById(element.parentNode.getAttribute("data-idholder")).setAttribute('data-broadcastname',""+document.getElementById("emailNameOfBroadcast").value+"");
		
		document.getElementById(element.parentNode.getAttribute("data-idholder")).setAttribute('data-whoemailfrom',""+document.getElementById("emailWhoItFrom").value+"");
		
		document.getElementById(element.parentNode.getAttribute("data-idholder")).setAttribute('data-emailsubjectline',""+document.getElementById("emailSubjectLine").value+"");
		
		document.getElementById(element.parentNode.getAttribute("data-idholder")).setAttribute('data-checkboxopentracking',""+document.getElementById("emailOpenTracking").checked+"");
		
		document.getElementById(element.parentNode.getAttribute("data-idholder")).setAttribute('data-checkboxclicktracking',""+document.getElementById("emailClickTracking").checked+"");

		document.getElementById(element.parentNode.getAttribute("data-idholder")).setAttribute('data-checkboxgoogleanalyticstracking',""+document.getElementById("emailClickGoogleAnalytics").checked+"");

		
		

		//alert(document.getElementById(element.parentNode.getAttribute("data-idholder")).getAttribute('data-checkboxgoogleanalyticstracking'));
	}
</script>

<script>
	function saveEmailPageTwo(element){
		//alert(element.parentNode.getAttribute("data-idholder"));

		document.getElementById(element.parentNode.getAttribute("data-idholder")).setAttribute('data-emailcontent',""+document.getElementById("emailtextarea").value+"");
		//alert(document.getElementById("emailtextarea").value);
		alert(document.getElementById(element.parentNode.getAttribute("data-idholder")).getAttribute('data-emailcontent'));

	}
</script>

<script>
	
 	//$('#emailtextarea').summernote();

	const editor = Jodit.make("#emailtextarea");

</script>


<script>
	function useEmail(element){
		
		//document.getelementsbyclassname('bg-modal').style.display = "block";
		//document.getElementById("emailContainer").style.display = "block";
		document.getElementById("myuseEmail").style.display = "block";
		//document.getElementById("myuseEmail").style.display = "none";
		//alert(element.parentNode.parentNode.id);
		document.getElementById("myuseEmail").setAttribute('data-idholder',""+element.parentNode.parentNode.id+"");
		//alert(document.getElementById("myuseEmail").getAttribute('data-idholder'));
	}
</script>

<script>
	function gotoEmailPage(element){

		document.getElementById("myuseEmail").style.display = "none";
		document.getElementById("myuseEmail2").style.display = "block";
		document.getElementById("myuseEmail2").setAttribute('data-idholder', document.getElementById("myuseEmail").getAttribute('data-idholder'))
		//document.getElementById("myuseEmail").data('data-idholder')
	}
</script>

<script>
	function removePopup(element){
		//document.getElementById("emailContainer").style.display = "none";

		document.getElementById("myuseEmail").style.display = "none";


		document.getElementById("emailNameOfBroadcast").value = "";

		document.getElementById("emailWhoItFrom").value = "";

		document.getElementById("emailSubjectLine").value = "";

		document.getElementById("emailOpenTracking").checked = false;

		document.getElementById("emailClickTracking").checked = false;

		document.getElementById("emailClickGoogleAnalytics").checked = false;
		

		
		
		
	}
</script>

<script>
	function removePopup2(element){

		editor.value = "<p> </p>";
		//document.getElementById("emailtextarea").value = "<p> </p>";
		//document.getElementById("emailtextarea").innerHTML = "";
		//document.getElementById("emailtextarea").innerText = "";
		//document.getElementById("emailtextarea").textContent = "";
		//$('#emailtextarea').summernote();
		//$('#emailtextarea').summernote('pasteHTML',"<p>Hello</p>");
		//$('#emailtextarea').summernote();
		//alert(document.getElementById("emailtextarea").value);

		document.getElementById("myuseEmail2").style.display = "none";
		document.getElementById("myuseEmail").style.display = "block";
	}
</script>

<script>
	
	function connectLine(element, color) {
		//localStorage.removeItem("Lineconnect");
		//alert(localStorage.getItem("Lineconnect"));
    	//element.style.color = color;


		if (localStorage.getItem("Lineconnect") === null) {
			alert("1"+element.parentNode.id);
			//localStorage.setItem("Lineconnect", element.parentNode.id +":"+"1px solid "+color);
			localStorage.setItem("Lineconnect", element.parentNode.id +":"+color);
			
			alert("1"+localStorage.getItem("Lineconnect"));
		}
		else{
			//alert(localStorage.getItem("Lineconnect"));
			var holder = localStorage.getItem("Lineconnect");
			localStorage.removeItem("Lineconnect");
			var c = holder.split(':');
			alert(c);

			$( document ).ready(function() {
				if (c[1] == 'black'){
					
					//var c7=new Connector({ele1: c[0], ele2: element.parentNode.id, lineStyle: ''+c[1]+'' ,class:'muConnector2' });
					var c7=new Connector({ele1: c[0], ele2: element.parentNode.id ,class:'muConnector2' });
					
					Setup(c7, c[0]);
					Setup(c7, element.parentNode.id);
				}
				if (c[1] == 'red'){
					//var c7=new Connector({ele1: c[0], ele2: element.parentNode.id, lineStyle: ''+c[1]+'' ,class:'muConnector' });
					var c7=new Connector({ele1: c[0], ele2: element.parentNode.id,class:'muConnector' });
					
					Setup(c7, c[0]);
					Setup(c7, element.parentNode.id);
				}
				if(c[1] == 'green'){
					//var c7=new Connector({ele1: c[0], ele2: element.parentNode.id, lineStyle: ''+c[1]+'' ,class:'muConnector3' });
					var c7=new Connector({ele1: c[0], ele2: element.parentNode.id ,class:'muConnector3' });
					
					Setup(c7, c[0]);
					Setup(c7, element.parentNode.id);
				}
				//var c7=new Connector({ele1: c[0], ele2: element.parentNode.id, lineStyle: ''+c[1]+'' });
				//Setup(c7, c[0]);
				//Setup(c7, element.parentNode.id);

				//i must put this in here for it to work
				function Setup(connector, id) {
					var ele=$('#'+id);
					ele.on('mousedown', function(e){
						
						//#critical: tell the connector about the starting position when the mouse goes down.
						connector.offsets[id].left=e.pageX - ele.offset().left;
						connector.offsets[id].top=e.pageY - ele.offset().top;
					
						e.preventDefault();
						
						//hook the mouse move			
						ele.on('mousemove', function(e){
						ele.css({left: e.pageX - connector.offsets[id].left, top: e.pageY - connector.offsets[id].top}); //element position = mouse - offset
						connector.moved(e, ele); // #critical: call the moved() function to update the connector position.
						});
						
						//define mouse up to cancel moving and mouse up, they are recreated each mousedown
						$(document).on('mouseup', function(e){
						ele.off('mousemove');
						//$(document).off('.muConnector');
						});
						
					});
				}
			})
			
			//(c[0],c[1],element,color)

			//localStorage.removeItem("Lineconnect");
			//alert("2"+localStorage.getItem("Lineconnect"));
		}
		
		
		//localStorage.setItem("Lineconnect",10);
	}
</script>

	<!--<div style="position:-webkit-sticky;position:sticky;left:0px">-->
	<div style="position:inherit">
	<div id="mydiv4" style="display: inline-block;top:65px;margin-left:49px;position:inherit;width:200px;height:650px;overflow-y: auto;z-index: 1;background-color: #f1f1f1;text-align: center;border: 1px solid #d3d3d3;">
		<p style="margin-top:35px">elements</p>
		<div id="mydiv5" style="width:150px;margin-top:5px;z-index: 9;background-color: #5aa7d3;text-align: center;border: 1px solid #d3d3d3;">
			<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
			<div id="mydiv5header" style="cursor: move;padding: 10px;z-index: 10;background-color: #2196F3;color: #8f4545;">Trigger</div>
			<p>Move</p>
			<p>this</p>
			<p>DIV</p>
		</div> 

		<div id="mydivdelay6" style="width:150px;margin-top:5px;z-index: 9;background-color: #727414;text-align: center;border: 1px solid #d3d3d3;">
			<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
			<div id="mydivdelay6header" style="cursor: move;padding: 10px;z-index: 10;background-color: #c2d97b;color: #2e664b;">Delay</div>
			<p>Move</p>
			<p>this</p>
			<p>DIV</p>
		</div> 

		<div id="mydivaction7" style="width:150px;margin-top:5px;z-index: 9;background-color: #17e8d6;text-align: center;border: 1px solid #d3d3d3;">
			<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
			<div id="mydivaction7header" style="cursor: move;padding: 10px;z-index: 10;background-color: #10b7c3;color: #8f4545;">Action</div>
			<p>Move</p>
			<p>this</p>
			<p>DIV</p>
		</div> 

		<div id="mydivcondition8" style="width:150px;margin-top:5px;z-index: 9;background-color: #d79c67;text-align: center;border: 1px solid #d3d3d3;">
			<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
			<div id="mydivcondition8header" style="cursor: move;padding: 10px;z-index: 10;background-color: #ba990a;color: #4a6f8c;">Condition</div>
			<p>Move</p>
			<p>this</p>
			<p>DIV</p>
		</div> 

		<div id="mydivemail9" style="width:150px;margin-top:5px;z-index: 9;background-color: #aa50e7;text-align: center;border: 1px solid #d3d3d3;">
			<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
			<div id="mydivemail9header" style="cursor: move;padding: 10px;z-index: 10;background-color: #a612f0;color: #231920;">Email</div>
			<p>Move</p>
			<p>this</p>
			<p>DIV</p>
		</div> 

		<div id="mydivstop10" style="width:150px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;">
			<!--Note: Absolute positioned elements are removed from the normal flow, and can overlap elements.-->
			<div id="mydivstop10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #85b0d0;">Stop</div>
			<p>Move</p>
			<p>this</p>
			<p>DIV</p>
		</div> 

	</div>   
	</div>




<script language="JavaScript" type="text/JavaScript">
    //Make the DIV element draggagle:
    //dragElement(document.getElementById("mydiv"));
    
	localStorage.setItem("Trigger",11);

	//dragElement2(document.getElementById("mydiv"));
    //dragElement2(document.getElementById("mydiv2"));
	dragElement(document.getElementById("mydiv5"));
	//dragElement(document.getElementById("mydiv10"));
    function dragElement(elmnt) {
      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	  //var mov = $('<div id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;"><div id="mydiv10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p>Move</p><p>this</p><p>DIV</p></div>');
	//var mov2 = $('<div style="width:150px;margin-top:5px;z-index: 9;background-color: ></div>')	
	  //document.body.appendChild(mov);
	  //elmnt.style.position = "absolute";

	  //$('body').append($('#mydiv4').children().first);
	
	  //var executed = false;
    
      
	  //const newDiv = document.createElement("div");

      // and give it some content
      //const newContent = document.createTextNode("Hi there and greetings!");

      // add the text node to the newly created div
	  
	  //if (!executed) {
      //      executed = true;
            // do something
		//	newDiv.appendChild(newContent);
        //}
	  //const currentDiv = document.getElementById("parent2");
	  

		
	  var attempts = parseInt(localStorage.getItem("Trigger"));
  	
	  var box = document.createElement("div");
	  box.innerHTML = '<div id="'+"mydiv"+attempts+"header"+'" style="cursor: move;padding: 10px;z-index: 10;background-color: #2196F3;color: #8f4545;">Trigger</div><p><button style="background-color: #e7e7e7;">Use</button></p><p><button style="background-color: #e7e7e7;">Delete</button></p><div style="display:inline-block;background-color: rgb(198, 198, 236);cursor:pointer;" onclick="connectLine(this, \'black\');" >&#x2192;</div>';
	  
	  //id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3; 
	  //alert(localStorage.getItem("Trigger"));
	  //box.id = "mydiv"+localStorage.getItem("Trigger").toString()+"";
	  
	  //box.id = "mydiv10";
	  //localStorage.setItem("Trigger", localStorage.getItem("Trigger")+1)
	  //alert(localStorage.getItem("Trigger"));
	  
	 // alert(box.innerHTML);
	 //id="'+"mydivdiv"+attempts+""+'"
	  //var divdiv = document.getElementById("mydivdiv10").addEventListener('click',function() {
  	  //connectLine('this', 'black');
	  //});


	  box.id = "mydiv"+attempts;
	  
	  
	  //alert(localStorage.getItem("Trigger"));
	  //alert(box.id);
	  //localStorage.setItem("Trigger", ++attempts);

	  box.style.position = "absolute";
	  box.style.width = "130px";
	  box.style.margintop = "50px";
	  box.style.zIndex = "9";
	  box.style.backgroundColor = "#5aa7d3";
	  box.style.textalign = "center";
	  box.style.border = "1px solid #d3d3d3"
	  box.classList.add("box");

	  
	  
	  
      if (document.getElementById(elmnt.id + "header")) {
        /* if present, the header is where you move the DIV from:*/
        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
      } else {
        /* otherwise, move the DIV from anywhere inside the DIV:*/
        elmnt.onmousedown = dragMouseDown;
      }
	  
      function dragMouseDown(e) {
        e = e || window.event;
		
        e.preventDefault();
		
		//elmnt.style.position = "absolute";
        // get the mouse cursor position at startup:
	
		
		

        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
      }
    
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();

		//$('body').append($('#mydiv4').children().first);
		//$('#mydiv4').children().first().remove()
		//elmnt.style.position = "absolute";

        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:


		/*
		var parent = document.createElement("div");
		parent.id = "graph";
		var child = document.createElement("div");
		child.id = "data";
		parent.appendChild(child);
		parent.preventDefault();
		parent.style.top = (elmnt.offsetTop - pos2) + "px";
		parent.style.left = (elmnt.offsetLeft - pos1) + "px";
		*/
		
		//elmnt.style.position = "absolute";


        //elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
		
		
		//div.style.position = 'absolute';
		//elmnt.style.top = e.clientY + 'px';
		//elmnt.style.left = e.clientX + 'px';

		
		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		//boxWrapper.style.top = e.clientY + 'px';
		//boxWrapper.style.left = e.clientX + 'px';

		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		box.style.top = e.clientY + 'px';
		box.style.left = e.clientX + 'px';



		//elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";

		//e.target.appendChild(boxWrapper);
		//newDiv.style.top = e.clientY + 'px';
		//newDiv.style.left = e.clientX + 'px';
		
        //document.getElementById(elmnt.id + "header").style.left = (elmnt.offsetLeft - pos1) + "px";
		//document.body.appendChild(mov)
		//$('body').append(mov)
		
		//document.body.appendChild(elmnt)
	}
    
      function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
		//$('body').append(elmnt);
		//document.body.appendChild(elmnt);
		
		//i need to make this run only once
		
		//var parent2 = document.getElementById("parent2");
		//parent2.append(box)
		//$('<div/>').attr({'data-role': 'draggable'}).draggable().appendTo("#parent2");
		//box.draggable()
		//dragElement(document.getElementById("mydiv10"));
		//$( "#mydiv10" ).attr({'data-role': 'draggable'})
		//$( "#mydiv10" ).draggable();

		//localStorage.setItem("Trigger", ++attempts);
		document.body.appendChild(box);

		dragElement2(document.getElementById("mydiv"+attempts));
		localStorage.setItem("Trigger", ++attempts);
		alert(attempts);
		dragElement(document.getElementById("mydiv5"));
      }
    }
    </script>












<script>

	//dragElement2(document.getElementById("mydiv"));
	//dragElement2(document.getElementById("mydiv2"));
    function dragElement2(elmnt) {
      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	  //var mov = $('<div id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;"><div id="mydiv10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p>Move</p><p>this</p><p>DIV</p></div>');
	//var mov2 = $('<div style="width:150px;margin-top:5px;z-index: 9;background-color: ></div>')	
	  //document.body.appendChild(mov);
	  //elmnt.style.position = "absolute";

	  //$('body').append($('#mydiv4').children().first);
	  
	  
      if (document.getElementById(elmnt.id + "header")) {
        /* if present, the header is where you move the DIV from:*/
        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
      } else {
        /* otherwise, move the DIV from anywhere inside the DIV:*/
        elmnt.onmousedown = dragMouseDown;
      }
	  
      function dragMouseDown(e) {
        e = e || window.event;
		
        e.preventDefault();
		
		//elmnt.style.position = "absolute";
        // get the mouse cursor position at startup:
	
		
		

        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
      }
    
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();

		//$('body').append($('#mydiv4').children().first);
		//$('#mydiv4').children().first().remove()
		//elmnt.style.position = "absolute";

        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:


		/*
		var parent = document.createElement("div");
		parent.id = "graph";
		var child = document.createElement("div");
		child.id = "data";
		parent.appendChild(child);
		parent.preventDefault();
		parent.style.top = (elmnt.offsetTop - pos2) + "px";
		parent.style.left = (elmnt.offsetLeft - pos1) + "px";
		*/
		
		elmnt.style.position = "absolute";


        elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
		
		
		//div.style.position = 'absolute';
		//elmnt.style.top = e.clientY + 'px';
		//elmnt.style.left = e.clientX + 'px';

		
		//var boxWrapper = document.getElementById("mydiv10");
		//boxWrapper.style.top = e.clientY + 'px';
		//boxWrapper.style.left = e.clientX + 'px';

		//e.target.appendChild(boxWrapper);
		//newDiv.style.top = e.clientY + 'px';
		//newDiv.style.left = e.clientX + 'px';
		
        //document.getElementById(elmnt.id + "header").style.left = (elmnt.offsetLeft - pos1) + "px";
		//document.body.appendChild(mov)
		//$('body').append(mov)
		
		//document.body.appendChild(elmnt)
	}
    
      function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
		//$('body').append(elmnt);
		//document.body.appendChild(elmnt);
		
		//i need to make this run only once
		
		//var parent2 = document.getElementById("parent2");
		//parent2.append(box)
		//$('<div/>').attr({'id': 'mydiv10parent2'}).draggable().appendTo("#parent2");
		//box.draggable()
		//dragElement(document.getElementById("mydiv10"));
		//$( "#mydiv10" ).draggable();
		//document.body.appendChild(box);
      }
    }
</script>







<!--second div-->
<script language="JavaScript" type="text/JavaScript">
    //Make the DIV element draggagle:
    //dragElement(document.getElementById("mydiv"));
    
	localStorage.setItem("Delay",11);

	//dragElement2(document.getElementById("mydiv"));
    //dragElement2(document.getElementById("mydiv2"));
	dragElement3(document.getElementById("mydivdelay6"));
	//dragElement(document.getElementById("mydiv10"));
    function dragElement3(elmnt) {
      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	  //var mov = $('<div id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;"><div id="mydiv10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p>Move</p><p>this</p><p>DIV</p></div>');
	//var mov2 = $('<div style="width:150px;margin-top:5px;z-index: 9;background-color: ></div>')	
	  //document.body.appendChild(mov);
	  //elmnt.style.position = "absolute";

	  //$('body').append($('#mydiv4').children().first);
	
	  //var executed = false;
    
      
	  //const newDiv = document.createElement("div");

      // and give it some content
      //const newContent = document.createTextNode("Hi there and greetings!");

      // add the text node to the newly created div
	  //newDiv.appendChild(newContent);
	  //if (!executed) {
      //      executed = true;
            // do something
		//	newDiv.appendChild(newContent);
        //}
	  //const currentDiv = document.getElementById("parent2");
	  //document.body.appendChild(newDiv);

		
	  var attempts = parseInt(localStorage.getItem("Delay"));
  	
	  var box = document.createElement("div");
	  box.innerHTML = '<div id="'+"mydivdelay"+attempts+"header"+'" style="cursor: move;padding: 10px;z-index: 10;background-color: #c2d97b;color: #2e664b;">Delay</div><p><button style="background-color: #e7e7e7;">Use</button></p><p><button style="background-color: #e7e7e7;">Delete</button></p><div style="display:inline-block;background-color: rgb(198, 198, 236);cursor:pointer;" onclick="connectLine(this, \'black\');" >&#x2192;</div>';




	  //id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3; 
	  //alert(localStorage.getItem("Trigger"));
	  //box.id = "mydiv"+localStorage.getItem("Trigger").toString()+"";
	  
	  //box.id = "mydiv10";
	  //localStorage.setItem("Trigger", localStorage.getItem("Trigger")+1)
	  //alert(localStorage.getItem("Trigger"));
	  
	 // alert(box.innerHTML);
	 //id="'+"mydivdiv"+attempts+""+'"
	  //var divdiv = document.getElementById("mydivdiv10").addEventListener('click',function() {
  	  //connectLine('this', 'black');
	  //});


	  box.id = "mydivdelay"+attempts;
	  
	  
	  //alert(localStorage.getItem("Trigger"));
	  //alert(box.id);
	  //localStorage.setItem("Trigger", ++attempts);

	  box.style.position = "absolute";
	  box.style.width = "130px";
	  box.style.margintop = "50px";
	  box.style.zIndex = "9";
	  box.style.backgroundColor = "#727414";
	  box.style.textalign = "center";
	  box.style.border = "1px solid #d3d3d3"
	  box.classList.add("box");


	  
	  
      if (document.getElementById(elmnt.id + "header")) {
        /* if present, the header is where you move the DIV from:*/
        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
      } else {
        /* otherwise, move the DIV from anywhere inside the DIV:*/
        elmnt.onmousedown = dragMouseDown;
      }
	  
      function dragMouseDown(e) {
        e = e || window.event;
		
        e.preventDefault();
		
		//elmnt.style.position = "absolute";
        // get the mouse cursor position at startup:
	
		
		

        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
      }
    
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();

		//$('body').append($('#mydiv4').children().first);
		//$('#mydiv4').children().first().remove()
		//elmnt.style.position = "absolute";

        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:


		/*
		var parent = document.createElement("div");
		parent.id = "graph";
		var child = document.createElement("div");
		child.id = "data";
		parent.appendChild(child);
		parent.preventDefault();
		parent.style.top = (elmnt.offsetTop - pos2) + "px";
		parent.style.left = (elmnt.offsetLeft - pos1) + "px";
		*/
		
		//elmnt.style.position = "absolute";


        //elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
		
		
		//div.style.position = 'absolute';
		//elmnt.style.top = e.clientY + 'px';
		//elmnt.style.left = e.clientX + 'px';

		
		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		//boxWrapper.style.top = e.clientY + 'px';
		//boxWrapper.style.left = e.clientX + 'px';

		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		box.style.top = e.clientY + 'px';
		box.style.left = e.clientX + 'px';



		//elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";

		//e.target.appendChild(boxWrapper);
		//newDiv.style.top = e.clientY + 'px';
		//newDiv.style.left = e.clientX + 'px';
		
        //document.getElementById(elmnt.id + "header").style.left = (elmnt.offsetLeft - pos1) + "px";
		//document.body.appendChild(mov)
		//$('body').append(mov)
		
		//document.body.appendChild(elmnt)
	}
    
      function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
		//$('body').append(elmnt);
		//document.body.appendChild(elmnt);
		
		//i need to make this run only once
		
		//var parent2 = document.getElementById("parent2");
		//parent2.append(box)
		//$('<div/>').attr({'data-role': 'draggable'}).draggable().appendTo("#parent2");
		//box.draggable()
		//dragElement(document.getElementById("mydiv10"));
		//$( "#mydiv10" ).attr({'data-role': 'draggable'})
		//$( "#mydiv10" ).draggable();

		//localStorage.setItem("Trigger", ++attempts);
		document.body.appendChild(box);

		dragElement2(document.getElementById("mydivdelay"+attempts));
		localStorage.setItem("Delay", ++attempts);
		alert(attempts);
		dragElement3(document.getElementById("mydivdelay6"));

		

      }
    }
    </script>


<!--third div-->
<script language="JavaScript" type="text/JavaScript">
    //Make the DIV element draggagle:
    //dragElement(document.getElementById("mydiv"));
    
	localStorage.setItem("Action",11);

	//dragElement2(document.getElementById("mydiv"));
    //dragElement2(document.getElementById("mydiv2"));
	dragElementaction(document.getElementById("mydivaction7"));
	//dragElement(document.getElementById("mydiv10"));
    function dragElementaction(elmnt) {
      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	  //var mov = $('<div id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;"><div id="mydiv10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p>Move</p><p>this</p><p>DIV</p></div>');
	//var mov2 = $('<div style="width:150px;margin-top:5px;z-index: 9;background-color: ></div>')	
	  //document.body.appendChild(mov);
	  //elmnt.style.position = "absolute";

	  //$('body').append($('#mydiv4').children().first);
	
	  //var executed = false;
    
      
	  //const newDiv = document.createElement("div");

      // and give it some content
      //const newContent = document.createTextNode("Hi there and greetings!");

      // add the text node to the newly created div
	  //newDiv.appendChild(newContent);
	  //if (!executed) {
      //      executed = true;
            // do something
		//	newDiv.appendChild(newContent);
        //}
	  //const currentDiv = document.getElementById("parent2");
	  //document.body.appendChild(newDiv);

		
	  var attempts = parseInt(localStorage.getItem("Action"));
  	
	  var box = document.createElement("div");
	  box.innerHTML = '<div id="'+"mydivaction"+attempts+"header"+'" style="cursor: move;padding: 10px;z-index: 10;background-color: #10b7c3;color: #8f4545;">Action</div><p><button style="background-color: #e7e7e7;">Use</button></p><p><button style="background-color: #e7e7e7;">Delete</button></p><div style="display:inline-block;background-color: rgb(198, 198, 236);cursor:pointer;" onclick="connectLine(this, \'black\');" >&#x2192;</div>';



	  //id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3; 
	  //alert(localStorage.getItem("Trigger"));
	  //box.id = "mydiv"+localStorage.getItem("Trigger").toString()+"";
	  
	  //box.id = "mydiv10";
	  //localStorage.setItem("Trigger", localStorage.getItem("Trigger")+1)
	  //alert(localStorage.getItem("Trigger"));
	  
	 // alert(box.innerHTML);
	 //id="'+"mydivdiv"+attempts+""+'"
	  //var divdiv = document.getElementById("mydivdiv10").addEventListener('click',function() {
  	  //connectLine('this', 'black');
	  //});


	  box.id = "mydivaction"+attempts;
	  
	  
	  //alert(localStorage.getItem("Trigger"));
	  //alert(box.id);
	  //localStorage.setItem("Trigger", ++attempts);

	  box.style.position = "absolute";
	  box.style.width = "130px";
	  box.style.margintop = "50px";
	  box.style.zIndex = "9";
	  box.style.backgroundColor = "#17e8d6";
	  box.style.textalign = "center";
	  box.style.border = "1px solid #d3d3d3"
	  box.classList.add("box");


	  
	  
      if (document.getElementById(elmnt.id + "header")) {
        /* if present, the header is where you move the DIV from:*/
        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
      } else {
        /* otherwise, move the DIV from anywhere inside the DIV:*/
        elmnt.onmousedown = dragMouseDown;
      }
	  
      function dragMouseDown(e) {
        e = e || window.event;
		
        e.preventDefault();
		
		//elmnt.style.position = "absolute";
        // get the mouse cursor position at startup:
	
		
		

        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
      }
    
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();

		//$('body').append($('#mydiv4').children().first);
		//$('#mydiv4').children().first().remove()
		//elmnt.style.position = "absolute";

        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:


		/*
		var parent = document.createElement("div");
		parent.id = "graph";
		var child = document.createElement("div");
		child.id = "data";
		parent.appendChild(child);
		parent.preventDefault();
		parent.style.top = (elmnt.offsetTop - pos2) + "px";
		parent.style.left = (elmnt.offsetLeft - pos1) + "px";
		*/
		
		//elmnt.style.position = "absolute";


        //elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
		
		
		//div.style.position = 'absolute';
		//elmnt.style.top = e.clientY + 'px';
		//elmnt.style.left = e.clientX + 'px';

		
		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		//boxWrapper.style.top = e.clientY + 'px';
		//boxWrapper.style.left = e.clientX + 'px';

		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		box.style.top = e.clientY + 'px';
		box.style.left = e.clientX + 'px';



		//elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";

		//e.target.appendChild(boxWrapper);
		//newDiv.style.top = e.clientY + 'px';
		//newDiv.style.left = e.clientX + 'px';
		
        //document.getElementById(elmnt.id + "header").style.left = (elmnt.offsetLeft - pos1) + "px";
		//document.body.appendChild(mov)
		//$('body').append(mov)
		
		//document.body.appendChild(elmnt)
	}
    
      function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
		//$('body').append(elmnt);
		//document.body.appendChild(elmnt);
		
		//i need to make this run only once
		
		//var parent2 = document.getElementById("parent2");
		//parent2.append(box)
		//$('<div/>').attr({'data-role': 'draggable'}).draggable().appendTo("#parent2");
		//box.draggable()
		//dragElement(document.getElementById("mydiv10"));
		//$( "#mydiv10" ).attr({'data-role': 'draggable'})
		//$( "#mydiv10" ).draggable();

		//localStorage.setItem("Trigger", ++attempts);
		document.body.appendChild(box);

		dragElement2(document.getElementById("mydivaction"+attempts));
		localStorage.setItem("Action", ++attempts);
		alert(attempts);
		dragElementaction(document.getElementById("mydivaction7"));

		

      }
    }
    </script>


<!--fourth div-->
<script language="JavaScript" type="text/JavaScript">
    //Make the DIV element draggagle:
    //dragElement(document.getElementById("mydiv"));
    
	localStorage.setItem("Condition",11);

	//dragElement2(document.getElementById("mydiv"));
    //dragElement2(document.getElementById("mydiv2"));
	dragElementcondition(document.getElementById("mydivcondition8"));
	//dragElement(document.getElementById("mydiv10"));
    function dragElementcondition(elmnt) {
      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	  //var mov = $('<div id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;"><div id="mydiv10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p>Move</p><p>this</p><p>DIV</p></div>');
	//var mov2 = $('<div style="width:150px;margin-top:5px;z-index: 9;background-color: ></div>')	
	  //document.body.appendChild(mov);
	  //elmnt.style.position = "absolute";

	  //$('body').append($('#mydiv4').children().first);
	
	  //var executed = false;
    
      
	  //const newDiv = document.createElement("div");

      // and give it some content
      //const newContent = document.createTextNode("Hi there and greetings!");

      // add the text node to the newly created div
	  //newDiv.appendChild(newContent);
	  //if (!executed) {
      //      executed = true;
            // do something
		//	newDiv.appendChild(newContent);
        //}
	  //const currentDiv = document.getElementById("parent2");
	  //document.body.appendChild(newDiv);

		
	  var attempts = parseInt(localStorage.getItem("Condition"));
  	
	  var box = document.createElement("div");
	  box.innerHTML = '<div id="'+"mydivcondition"+attempts+"header"+'" style="cursor: move;padding: 10px;z-index: 10;background-color: #ba990a;color: #4a6f8c;">Condition</div><p><button style="background-color: #e7e7e7;">Use</button></p><p><button style="background-color: #e7e7e7;">Delete</button></p><div style="display:inline-block;background-color:rgb(250, 107, 94);cursor:pointer;" onclick="connectLine(this, \'red\');" >&#x2190;</div> <div style="display:inline-block;background-color: rgb(90, 243, 159);cursor:pointer;" onclick="connectLine(this, \'green\')">&#x2192;</div>';

	
	  


	  //id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3; 
	  //alert(localStorage.getItem("Trigger"));
	  //box.id = "mydiv"+localStorage.getItem("Trigger").toString()+"";
	  
	  //box.id = "mydiv10";
	  //localStorage.setItem("Trigger", localStorage.getItem("Trigger")+1)
	  //alert(localStorage.getItem("Trigger"));
	  
	 // alert(box.innerHTML);
	 //id="'+"mydivdiv"+attempts+""+'"
	  //var divdiv = document.getElementById("mydivdiv10").addEventListener('click',function() {
  	  //connectLine('this', 'black');
	  //});


	  box.id = "mydivcondition"+attempts;
	  
	  
	  //alert(localStorage.getItem("Trigger"));
	  //alert(box.id);
	  //localStorage.setItem("Trigger", ++attempts);

	  box.style.position = "absolute";
	  box.style.width = "130px";
	  box.style.margintop = "50px";
	  box.style.zIndex = "9";
	  box.style.backgroundColor = "#d79c67";
	  box.style.textalign = "center";
	  box.style.border = "1px solid #d3d3d3"
	  box.classList.add("box");

 
	  
	  
      if (document.getElementById(elmnt.id + "header")) {
        /* if present, the header is where you move the DIV from:*/
        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
      } else {
        /* otherwise, move the DIV from anywhere inside the DIV:*/
        elmnt.onmousedown = dragMouseDown;
      }
	  
      function dragMouseDown(e) {
        e = e || window.event;
		
        e.preventDefault();
		
		//elmnt.style.position = "absolute";
        // get the mouse cursor position at startup:
	
		
		

        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
      }
    
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();

		//$('body').append($('#mydiv4').children().first);
		//$('#mydiv4').children().first().remove()
		//elmnt.style.position = "absolute";

        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:


		/*
		var parent = document.createElement("div");
		parent.id = "graph";
		var child = document.createElement("div");
		child.id = "data";
		parent.appendChild(child);
		parent.preventDefault();
		parent.style.top = (elmnt.offsetTop - pos2) + "px";
		parent.style.left = (elmnt.offsetLeft - pos1) + "px";
		*/
		
		//elmnt.style.position = "absolute";


        //elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
		
		
		//div.style.position = 'absolute';
		//elmnt.style.top = e.clientY + 'px';
		//elmnt.style.left = e.clientX + 'px';

		
		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		//boxWrapper.style.top = e.clientY + 'px';
		//boxWrapper.style.left = e.clientX + 'px';

		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		box.style.top = e.clientY + 'px';
		box.style.left = e.clientX + 'px';



		//elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";

		//e.target.appendChild(boxWrapper);
		//newDiv.style.top = e.clientY + 'px';
		//newDiv.style.left = e.clientX + 'px';
		
        //document.getElementById(elmnt.id + "header").style.left = (elmnt.offsetLeft - pos1) + "px";
		//document.body.appendChild(mov)
		//$('body').append(mov)
		
		//document.body.appendChild(elmnt)
	}
    
      function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
		//$('body').append(elmnt);
		//document.body.appendChild(elmnt);
		
		//i need to make this run only once
		
		//var parent2 = document.getElementById("parent2");
		//parent2.append(box)
		//$('<div/>').attr({'data-role': 'draggable'}).draggable().appendTo("#parent2");
		//box.draggable()
		//dragElement(document.getElementById("mydiv10"));
		//$( "#mydiv10" ).attr({'data-role': 'draggable'})
		//$( "#mydiv10" ).draggable();

		//localStorage.setItem("Trigger", ++attempts);
		document.body.appendChild(box);

		dragElement2(document.getElementById("mydivcondition"+attempts));
		localStorage.setItem("Condition", ++attempts);
		alert(attempts);
		dragElementcondition(document.getElementById("mydivcondition8"));

		

      }
    }
    </script>



<!--fifth div-->
<script language="JavaScript" type="text/JavaScript">
    //Make the DIV element draggagle:
    //dragElement(document.getElementById("mydiv"));
    
	localStorage.setItem("Email",11);

	//dragElement2(document.getElementById("mydiv"));
    //dragElement2(document.getElementById("mydiv2"));
	dragElementstop(document.getElementById("mydivemail9"));
	//dragElement(document.getElementById("mydiv10"));
    function dragElementstop(elmnt) {
      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	  //var mov = $('<div id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;"><div id="mydiv10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p>Move</p><p>this</p><p>DIV</p></div>');
	//var mov2 = $('<div style="width:150px;margin-top:5px;z-index: 9;background-color: ></div>')	
	  //document.body.appendChild(mov);
	  //elmnt.style.position = "absolute";

	  //$('body').append($('#mydiv4').children().first);
	
	  //var executed = false;
    
      
	  //const newDiv = document.createElement("div");

      // and give it some content
      //const newContent = document.createTextNode("Hi there and greetings!");

      // add the text node to the newly created div
	  //newDiv.appendChild(newContent);
	  //if (!executed) {
      //      executed = true;
            // do something
		//	newDiv.appendChild(newContent);
        //}
	  //const currentDiv = document.getElementById("parent2");
	  //document.body.appendChild(newDiv);

		
	  var attempts = parseInt(localStorage.getItem("Email"));
  	
	  var box = document.createElement("div");
	  box.innerHTML = '<div id="'+"mydivemail"+attempts+"header"+'" style="cursor: move;padding: 10px;z-index: 10;background-color: #a612f0;color: #231920;">Email</div><p><button style="background-color: #e7e7e7;">Use</button></p><p><button style="background-color: #e7e7e7;">Delete</button></p><div style="display:inline-block;background-color: rgb(198, 198, 236);cursor:pointer;" onclick="connectLine(this, \'black\');" >&#x2192;</div>';

	  




	  //id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3; 
	  //alert(localStorage.getItem("Trigger"));
	  //box.id = "mydiv"+localStorage.getItem("Trigger").toString()+"";
	  
	  //box.id = "mydiv10";
	  //localStorage.setItem("Trigger", localStorage.getItem("Trigger")+1)
	  //alert(localStorage.getItem("Trigger"));
	  
	 // alert(box.innerHTML);
	 //id="'+"mydivdiv"+attempts+""+'"
	  //var divdiv = document.getElementById("mydivdiv10").addEventListener('click',function() {
  	  //connectLine('this', 'black');
	  //});


	  box.id = "mydivemail"+attempts;
	  
	  
	  //alert(localStorage.getItem("Trigger"));
	  //alert(box.id);
	  //localStorage.setItem("Trigger", ++attempts);

	  box.style.position = "absolute";
	  box.style.width = "130px";
	  box.style.margintop = "50px";
	  box.style.zIndex = "9";
	  box.style.backgroundColor = "#aa50e7";
	  box.style.textalign = "center";
	  box.style.border = "1px solid #d3d3d3"
	  box.classList.add("box");

	
	  
	  
      if (document.getElementById(elmnt.id + "header")) {
        /* if present, the header is where you move the DIV from:*/
        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
      } else {
        /* otherwise, move the DIV from anywhere inside the DIV:*/
        elmnt.onmousedown = dragMouseDown;
      }
	  
      function dragMouseDown(e) {
        e = e || window.event;
		
        e.preventDefault();
		
		//elmnt.style.position = "absolute";
        // get the mouse cursor position at startup:
	
		
		

        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
      }
    
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();

		//$('body').append($('#mydiv4').children().first);
		//$('#mydiv4').children().first().remove()
		//elmnt.style.position = "absolute";

        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:


		/*
		var parent = document.createElement("div");
		parent.id = "graph";
		var child = document.createElement("div");
		child.id = "data";
		parent.appendChild(child);
		parent.preventDefault();
		parent.style.top = (elmnt.offsetTop - pos2) + "px";
		parent.style.left = (elmnt.offsetLeft - pos1) + "px";
		*/
		
		//elmnt.style.position = "absolute";


        //elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
		
		
		//div.style.position = 'absolute';
		//elmnt.style.top = e.clientY + 'px';
		//elmnt.style.left = e.clientX + 'px';

		
		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		//boxWrapper.style.top = e.clientY + 'px';
		//boxWrapper.style.left = e.clientX + 'px';

		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		box.style.top = e.clientY + 'px';
		box.style.left = e.clientX + 'px';



		//elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";

		//e.target.appendChild(boxWrapper);
		//newDiv.style.top = e.clientY + 'px';
		//newDiv.style.left = e.clientX + 'px';
		
        //document.getElementById(elmnt.id + "header").style.left = (elmnt.offsetLeft - pos1) + "px";
		//document.body.appendChild(mov)
		//$('body').append(mov)
		
		//document.body.appendChild(elmnt)
	}
    
      function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
		//$('body').append(elmnt);
		//document.body.appendChild(elmnt);
		
		//i need to make this run only once
		
		//var parent2 = document.getElementById("parent2");
		//parent2.append(box)
		//$('<div/>').attr({'data-role': 'draggable'}).draggable().appendTo("#parent2");
		//box.draggable()
		//dragElement(document.getElementById("mydiv10"));
		//$( "#mydiv10" ).attr({'data-role': 'draggable'})
		//$( "#mydiv10" ).draggable();

		//localStorage.setItem("Trigger", ++attempts);
		document.body.appendChild(box);

		dragElement2(document.getElementById("mydivemail"+attempts));
		localStorage.setItem("Email", ++attempts);
		alert(attempts);
		dragElementstop(document.getElementById("mydivemail9"));

		

      }
    }
    </script>



<!--sisth div-->
<script language="JavaScript" type="text/JavaScript">
    //Make the DIV element draggagle:
    //dragElement(document.getElementById("mydiv"));
    
	localStorage.setItem("Stop",11);

	//dragElement2(document.getElementById("mydiv"));
    //dragElement2(document.getElementById("mydiv2"));
	dragElementstop(document.getElementById("mydivstop10"));
	//dragElement(document.getElementById("mydiv10"));
    function dragElementstop(elmnt) {
      var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	  //var mov = $('<div id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3;"><div id="mydiv10header" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p>Move</p><p>this</p><p>DIV</p></div>');
	//var mov2 = $('<div style="width:150px;margin-top:5px;z-index: 9;background-color: ></div>')	
	  //document.body.appendChild(mov);
	  //elmnt.style.position = "absolute";

	  //$('body').append($('#mydiv4').children().first);
	
	  //var executed = false;
    
      
	  //const newDiv = document.createElement("div");

      // and give it some content
      //const newContent = document.createTextNode("Hi there and greetings!");

      // add the text node to the newly created div
	  //newDiv.appendChild(newContent);
	  //if (!executed) {
      //      executed = true;
            // do something
		//	newDiv.appendChild(newContent);
        //}
	  //const currentDiv = document.getElementById("parent2");
	  //document.body.appendChild(newDiv);

		
	  var attempts = parseInt(localStorage.getItem("Stop"));
  	
	  var box = document.createElement("div");
	  box.innerHTML = '<div id="'+"mydivstop"+attempts+"header"+'" style="cursor: move;padding: 10px;z-index: 10;background-color: #93479b;color: #4a6f8c;">Stop</div><p><button style="background-color: #e7e7e7;">Delete</button></p><div style="display:inline-block;background-color: rgb(198, 198, 236);cursor:pointer;" onclick="connectLine(this, \'black\');" >&#x2192;</div>';

	



	  //id="mydiv10" style="width:130px;margin-top:5px;z-index: 9;background-color: #c66198;text-align: center;border: 1px solid #d3d3d3; 
	  //alert(localStorage.getItem("Trigger"));
	  //box.id = "mydiv"+localStorage.getItem("Trigger").toString()+"";
	  
	  //box.id = "mydiv10";
	  //localStorage.setItem("Trigger", localStorage.getItem("Trigger")+1)
	  //alert(localStorage.getItem("Trigger"));
	  
	 // alert(box.innerHTML);
	 //id="'+"mydivdiv"+attempts+""+'"
	  //var divdiv = document.getElementById("mydivdiv10").addEventListener('click',function() {
  	  //connectLine('this', 'black');
	  //});


	  box.id = "mydivstop"+attempts;
	  
	  
	  //alert(localStorage.getItem("Trigger"));
	  //alert(box.id);
	  //localStorage.setItem("Trigger", ++attempts);

	  box.style.position = "absolute";
	  box.style.width = "130px";
	  box.style.margintop = "50px";
	  box.style.zIndex = "9";
	  box.style.backgroundColor = "#c66198";
	  box.style.textalign = "center";
	  box.style.border = "1px solid #d3d3d3"
	  box.classList.add("box");

	
	  
	  
      if (document.getElementById(elmnt.id + "header")) {
        /* if present, the header is where you move the DIV from:*/
        document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
      } else {
        /* otherwise, move the DIV from anywhere inside the DIV:*/
        elmnt.onmousedown = dragMouseDown;
      }
	  
      function dragMouseDown(e) {
        e = e || window.event;
		
        e.preventDefault();
		
		//elmnt.style.position = "absolute";
        // get the mouse cursor position at startup:
	
		
		

        pos3 = e.clientX;
        pos4 = e.clientY;
        document.onmouseup = closeDragElement;
        // call a function whenever the cursor moves:
        document.onmousemove = elementDrag;
      }
    
      function elementDrag(e) {
        e = e || window.event;
        e.preventDefault();

		//$('body').append($('#mydiv4').children().first);
		//$('#mydiv4').children().first().remove()
		//elmnt.style.position = "absolute";

        // calculate the new cursor position:
        pos1 = pos3 - e.clientX;
        pos2 = pos4 - e.clientY;
        pos3 = e.clientX;
        pos4 = e.clientY;
        // set the element's new position:


		/*
		var parent = document.createElement("div");
		parent.id = "graph";
		var child = document.createElement("div");
		child.id = "data";
		parent.appendChild(child);
		parent.preventDefault();
		parent.style.top = (elmnt.offsetTop - pos2) + "px";
		parent.style.left = (elmnt.offsetLeft - pos1) + "px";
		*/
		
		//elmnt.style.position = "absolute";


        //elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
		
		
		//div.style.position = 'absolute';
		//elmnt.style.top = e.clientY + 'px';
		//elmnt.style.left = e.clientX + 'px';

		
		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		//boxWrapper.style.top = e.clientY + 'px';
		//boxWrapper.style.left = e.clientX + 'px';

		//var boxWrapper = document.getElementById("mydiv"+attempts);
		//alert(boxWrapper)
		box.style.top = e.clientY + 'px';
		box.style.left = e.clientX + 'px';



		//elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
        //elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";

		//e.target.appendChild(boxWrapper);
		//newDiv.style.top = e.clientY + 'px';
		//newDiv.style.left = e.clientX + 'px';
		
        //document.getElementById(elmnt.id + "header").style.left = (elmnt.offsetLeft - pos1) + "px";
		//document.body.appendChild(mov)
		//$('body').append(mov)
		
		//document.body.appendChild(elmnt)
	}
    
      function closeDragElement() {
        /* stop moving when mouse button is released:*/
        document.onmouseup = null;
        document.onmousemove = null;
		//$('body').append(elmnt);
		//document.body.appendChild(elmnt);
		
		//i need to make this run only once
		
		//var parent2 = document.getElementById("parent2");
		//parent2.append(box)
		//$('<div/>').attr({'data-role': 'draggable'}).draggable().appendTo("#parent2");
		//box.draggable()
		//dragElement(document.getElementById("mydiv10"));
		//$( "#mydiv10" ).attr({'data-role': 'draggable'})
		//$( "#mydiv10" ).draggable();

		//localStorage.setItem("Trigger", ++attempts);
		document.body.appendChild(box);

		dragElement2(document.getElementById("mydivstop"+attempts));
		localStorage.setItem("Stop", ++attempts);
		alert(attempts);
		dragElementstop(document.getElementById("mydivstop10"));

		

      }
    }
    </script>





<div style="display: inline-block;position:inherit;margin-left: 0px;overflow:visible;height:700px; width:1400px; border:solid 1px black;" id='parent'>
	<div style="position:inherit;margin-left: 0px;overflow:scroll;height:2800px; width:5600px; border:solid 1px black;" id='parent2'></div>
	
</div>




<div class="container" style="display: inline-block;overflow:scroll;width:300px;height:50px">
    <div class="drag" id="drag" data-role="draggable">
      Dragg Me!
    </div>
</div>
<!--
<script>
	
	window.onload = dragListeners();


function dragListeners() {
  document.getElementById('mydiv5').addEventListener('mousedown', mouseDown, false);
  window.addEventListener('mouseup', mouseUp, false);
}


function mouseUp() {
  window.removeEventListener('mousemove', moveDiv, true);
}


function mouseDown(e) {
  const div = document.getElementById('mydiv5');
  div.setAttribute("cursor", "pointer");


  window.addEventListener('mousemove', moveDiv, true);
}


function moveDiv(e) {
  const div = document.getElementById('mydiv5');
  div.setAttribute("cursor", "pointer");


  div.style.position = 'absolute';
  div.style.top = e.clientY + 'px';
  div.style.left = e.clientX + 'px';
}
</script>
-->




<!--
<div style="overflow:hihdden; height:750px; width:1700px;">
	

	<div class="parent" style="position: relative;margin-left: 0px;overflow:auto;height:1500px; width:3400px; border:solid 1px black;top: 0;left: 0;" id='parent'>

		<div id="mydiv3" class="draggable" style="top:45px;left:85px;position: absolute;z-index: 9;background-color: #f1f1f1;text-align: center;border: 1px solid #d3d3d3;">
			<div id="mydiv3header"  style="padding: 10px;z-index: 10;background-color: #2196F3;color: #fff;">Click here to move</div>
			<p>Move</p>
			<p>this</p>
			<p>DIV</p>
		</div> 
	</div>>
</div>


<script>
 

 window.onload = () => {
	
	var logr = document.getElementById('report');
	
	  var parent = document.querySelector('.parent');
	  var parentRect = parent.getBoundingClientRect();
	  
	  var draggable = document.querySelector('.draggable');
	  var draggableRect = draggable.getBoundingClientRect();
	
	  
	  var dragging = false;
	  
	  
	  function moveStart(e)
	  {
		  e.preventDefault();
		  dragging = true;
	  }
	  
	  function moveEnd(e)
	  {
		  e.preventDefault();
		  dragging = false;
	  }
	  
	  function moving(e)
	  {
		  e.preventDefault();
		  if( dragging )
		  {
			  if( (e.clientX >= parentRect.left && (e.clientX+draggableRect.width <= parentRect.right)) &&
					(e.clientY >= parentRect.top && (e.clientY+draggableRect.height <= parentRect.bottom))  
				){
		  //add draggableRect.width draggableRect.height accoints for
				  draggable.style.left = `${e.clientX}px`;
				  draggable.style.top = `${e.clientY}px`;
			  }
		else{
		  //if mouse went out of bounds in Horizontal dir.
		  if(e.clientX+draggableRect.width >= parentRect.right){
			 draggable.style.left = `${parentRect.right-draggableRect.width}px`;
		  }
		  //if mouse went out of bounds in Vertical dir.
		  if(e.clientY+draggableRect.height >= parentRect.bottom){
			 draggable.style.top = `${parentRect.bottom-draggableRect.height}px`;
		  }
		}
		
		  }			
   
	  }
	  
	  
	  document.addEventListener('mousedown', moveStart);
	  document.addEventListener('mousemove', moving);
	  document.addEventListener('mouseup', moveEnd);
	  
  }

</script>
-->


<style>
  .thing {
  width: 200px;
  height: 100px;
  background: transparent;
  position: absolute;
  border: 1px solid #666666;
}

.thing span {
  display: block;
  margin-left: 95px;
  margin-top: 40px;
}

.muConnector {
  position: absolute;
  border-left: 1px dashed red;
  z-index: 100;
  -webkit-transform-origin: top left;
  -moz-transform-origin: top left;
  -o-transform-origin: top left;
  -ms-transform-origin: top left;
  transform-origin: top left;
}
.muConnector2 {
  position: absolute;
  border-left: 1px dashed rgb(7, 5, 5);
  z-index: 100;
  -webkit-transform-origin: top left;
  -moz-transform-origin: top left;
  -o-transform-origin: top left;
  -ms-transform-origin: top left;
  transform-origin: top left;
}
.muConnector3 {
  position: absolute;
  border-left: 1px dashed rgb(10, 245, 111);
  z-index: 100;
  -webkit-transform-origin: top left;
  -moz-transform-origin: top left;
  -o-transform-origin: top left;
  -ms-transform-origin: top left;
  transform-origin: top left;
}
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<span>Drag any box...</span>

  <div id="a" class='thing' style='left:400px; top: 100px;' data-id="a">
    <span>a</span>
  </div>
  
  
  <div id="b" class='thing' style='left:600px; top: 300px;' data-id="b">
    <span>b</span>
  </div>

  <div id="c" class='thing' style='left:400px; top: 500px;' data-id="c">
    <span>c</span>
  </div>
  
  
  <div id="d" class='thing' style='left:200px; top: 300px;' data-id="d">
    <span>d</span>
  </div>


    <script>


      /*
muConnector - a class to create a line joining two elements.

To use, call new with id's of both elements and optonal lineStyle (which must be a valid css border line def such as '1px solid #000' , e.g.
var c1=new Connector(id1, id2, lineStyle)

Default line style is '1px solid #666666'

Whatever you use for drag control, call moved(e, ele) per increment of movement, where e=event and ele=the jq element being moved.

*/

var Connector = function(params) {
if (typeof(params) == "undefined") { return false }; // If no params then abandon.
// Process input params.
var ele1=params.ele1 || '';   // First element to link
var ele2=params.ele2 || '';   // Second element to link
if ( ele1.length === 0 || ele2.length === 0)  { return false }; // If not two element id's then abandon. 

var className=params.class || 'muConnector'

var lineStyle=params.lineStyle || '1px solid #666666';   // CSS style for connector line.

this.gapX1=params.gapX1 || 0;  // First element gap before start of connector, etc
this.gapY1=params.gapY1 || 0;  
this.gapX2=params.gapX2 || 0;
this.gapY2=params.gapY2 || 0;


this.gap=params.gap || 0; // use a single gap setting.
if ( this.gap > 0 ) {
	this.gapX1 = this.gap
	this.gapY1 = this.gap
	this.gapX2 = this.gap
	this.gapY2 = this.gap
}

var pos = function() { // only used for standalone drag processing.
	this.left = 0;
	this.top = 0;
}
		
this.PseudoGuid = new (function() { // Make a GUID to use in unique id assignment - from and credit to http://stackoverflow.com/questions/226689/unique-element-id-even-if-element-doesnt-have-one
	this.empty = "00000000-0000-0000-0000-000000000000";
	this.GetNew = function() {
		var fC = function() { return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1).toUpperCase(); }
		return (fC() + fC() + "-" + fC() + "-" + fC() + "-" + fC() + "-" + fC() + fC() + fC());
	};
})();

this.id = this.PseudoGuid.GetNew(); // use guid to avoid id-clashes with manual code.
this.ele1=($('#'+ele1));
this.ele2=($('#'+ele2));



// Append the div that is the link line into the DOM
this.lineID='L' + this.id;
$('body').append("<div id='" + this.lineID + "' class='" + className + "' style=  ></div>")
this.line = $('#L'+ this.id);
this.line.css({ position: 'absolute', 'border-left': this.lineStyle, 'z-index': -100 }) 

// We may need to store the offsets of each element that we are connecting.
this.offsets=[];
this.offsets[ele1]=new pos;
this.offsets[ele2]=new pos;

this.link(); // show the initial link


//i just added this
//this.ele1.data("id","#"+ele2)
//this.ele2.data("id","#"+ele1)
if($('#'+ele1).data('data-id')===undefined && $('#'+ele2).data('data-id')!==undefined){
	$('#'+ele1).data('data-id',"["+ele1+"-("+$('#'+ele2).data('data-id') +")]");

	$('#'+ele2).data('data-id',"["+ele2+'-(#'+ele1+")]");

}
else if ($('#'+ele1).data('data-id')===undefined && $('#'+ele2).data('data-id')===undefined) {
	$('#'+ele1).data('data-id',"["+ele1+'-(#'+ele2+")]");

	$('#'+ele2).data('data-id',"["+ele2+'-(#'+ele1+")]");
	//$('#'+ele2).data('data-id',$('#'+ele2).data('data-id')+'#'+ele1);
}else if ($('#'+ele1).data('data-id')!==undefined && $('#'+ele2).data('data-id')===undefined){
	$('#'+ele1).data('data-id',"["+ele1+"-("+$('#'+ele1).data('data-id')+'#'+ele2+")]");

	//$('#'+ele2).data('data-id',"["+ele2+"-("+$('#'+ele1).data('data-id')+")]");
	$('#'+ele2).data('data-id',"["+ele2+'-(#'+ele1+")]");
}
else if ($('#'+ele1).data('data-id')!==undefined && $('#'+ele2).data('data-id')!==undefined){
	$('#'+ele1).data('data-id',"["+ele1+"-("+$('#'+ele1).data('data-id')+'#'+ele2+")]");
	$('#'+ele2).data('data-id',"["+ele2+"-("+$('#'+ele2).data('data-id')+'#'+ele1+")]");
}





//if ($('#'+ele1).data('data-id')!==undefined) {
//	$('#'+ele1).data('data-id',$('#'+ele1).data('data-id')+'#'+ele2);
//}
//if ($('#'+ele2).data('data-id')!==undefined) {
//	$('#'+ele2).data('data-id',$('#'+ele2).data('data-id')+'#'+ele1);
//}
//$('#'+ele1).data('id','#'+ele2);
//$('#'+ele2).data('id','#'+ele1);

//var a = $('#mydiv').data('myval'); //getter

//alert(a);

//alert($('#'+ele1).data('data-id'));
//alert($('#'+ele2).data('data-id'));


//const element = document.getElementById("L"+this.id);
//element.remove();
}

/*
Approach: draw a zero width rectangle where the top left is located at the centre of ele1. 
Compute and make rectangle height equal to the distance between centres of ele1 and ele2.
Now rotate the rectangle to the angle between the points.
Note tracks the edges of the elements so as not to overlay / underlay.
Also can accommodate a gap between edge of element and start of line.

*/	
//n JavaScript, a prototype can be used to add properties and methods to a constructor function. 
//And objects inherit properties and methods from a prototype. For example,
Connector.prototype.link=function link() {

	var originX = this.ele1.offset().left + this.ele1.outerWidth() / 2;
	var originY = this.ele1.offset().top + this.ele1.outerHeight() / 2;
  
	var targetX = this.ele2.offset().left + this.ele2.outerWidth() / 2;
	var targetY = this.ele2.offset().top + this.ele2.outerHeight() / 2;
	
	var l = this.hyp((targetX - originX),(targetY - originY));
	var angle = 180 / 3.1415 * Math.acos((targetY - originY) / l);
	if(targetX > originX) { angle = angle * -1 }
	
	// Compute adjustments to edge of element plus gaps.
	var adj1=this.edgeAdjust(angle, this.gapX1 + this.ele1.width() / 2, this.gapY1 + this.ele1.height() / 2)
	var adj2=this.edgeAdjust(angle, this.gapX2 + this.ele2.width() / 2, this.gapY2 + this.ele2.height() / 2)

 
	l = l - ( adj1.hp + adj2.hp)
	
	this.line.css({ left: originX, height: l, width: 0, top: originY +  adj1.hp })
		.css('-webkit-transform', 'rotate(' + angle + 'deg)')
		.css('-moz-transform', 'rotate(' + angle + 'deg)')
		.css('-o-transform', 'rotate(' + angle + 'deg)')
		.css('-ms-transform', 'rotate(' + angle + 'deg)')
		.css('transform', 'rotate(' + angle + 'deg)')
		.css('transform-origin', '0 ' + ( -1 * adj1.hp) + 'px');

  //this.line.class = "yo"
}

Connector.prototype.Round = function(value, places) {
    var multiplier = Math.pow(10, places);
    return (Math.round(value * multiplier) / multiplier);
}
	
Connector.prototype.edgeAdjust = function (a, w1, h1) {
	var w=0, h=0
	
	// compute corner angles
	var ca=[]
	ca[0]=Math.atan(w1/h1) * 180 / 3.1415926 // RADIANS !!!
	ca[1]=180 - ca[0]
	ca[2]=ca[0] + 180
	ca[3]=ca[1] + 180
	
	// Based on the possible sector and angle combinations work out the adjustments.
	if ( (this.Round(a,0) === 0)  ) {
		h=h1
		w=0
	}
	else if ( (this.Round(a,0) === 180)  ) {
		h=h1
		w=0
	}
	else if ( (a > 0 && a <= ca[0]) || (a < 0 && a >= (-1*ca[0]))  ) {
		h=h1
		w=-1 * Math.tan(a * ( 3.1415926 / 180)) * h1
	}
	
	else if (  a > ca[0] && a <= 90 ) {
		h=Math.tan((90-a) * ( 3.1415926 / 180)) * w1
		w=w1
	}
	else if (  a > 90 && a <= ca[1]  ) {
		h=-1 * Math.tan((a-90) * ( 3.1415926 / 180)) * w1
		w=w1
	}
	else if (  a > ca[1] && a <= 180  ) {
		h=h1
		w=-1 * Math.tan((180 - a) * ( 3.1415926 / 180)) * h1
	}
	else if (  a > -180 && a <= (-1 * ca[1])  ) {
		h=h1
		w= Math.tan((a - 180) * ( 3.1415926 / 180)) * h1
	}	
	else if (  a > (-1 * ca[1])  && a <=  0 ) {
		h=Math.tan((a-90) * ( 3.1415926 / 180)) * w1
		w= w1
	}	

	// We now have the width and height offsets - compute the hypotenuse.
	var hp=this.hyp(w, h)
	
	return {hp: hp }	
}		

Connector.prototype.hyp = function hyp(X, Y) {
return Math.abs(Math.sqrt( (X * X) + ( Y * Y) ))
}


Connector.prototype.moved=function moved(e, ele) {
	var id=ele.attr('id');
	this.link()
}





var line;
$( document ).ready(function() {
    console.log( "ready!" );

	var c1=new Connector({ele1: 'a', ele2: 'b', lineStyle: '1px solid red',class:'muConnector3' })
	Setup(c1, 'a');
	Setup(c1, 'b');
	
	var c2=new Connector({ele1: 'a', ele2: 'c', lineStyle: '1px solid red' })
	Setup(c2, 'a');
	Setup(c2, 'c');

	var c3=new Connector({ele1: 'a', ele2: 'd', lineStyle: '1px solid red' })
	Setup(c3, 'a');
	Setup(c3, 'd');
	
	var c4=new Connector({ele1: 'b', ele2: 'c'})
	Setup(c4, 'b');
	Setup(c4, 'c');	

	var c5=new Connector({ele1: 'b', ele2: 'd'})
	Setup(c5, 'b');
	Setup(c5, 'd');	
	
	var c6=new Connector({ele1: 'c', ele2: 'd'})
	Setup(c6, 'c');
	Setup(c6, 'd');

    //var c7=new Connector({ele1: 'mydiv', ele2: 'mydiv2'})
	//Setup(c7, 'mydiv');
	//Setup(c7, 'mydiv2');
  
  //const element = document.getElementsByClassName("yo");
  //element.remove();

	function Setup(connector, id) {
		var ele=$('#'+id);
		ele.on('mousedown.muConnector', function(e){
			
			//#critical: tell the connector about the starting position when the mouse goes down.
			connector.offsets[id].left=e.pageX - ele.offset().left;
			connector.offsets[id].top=e.pageY - ele.offset().top;
		
			e.preventDefault();
			
			//hook the mouse move			
			ele.on('mousemove.muConnector', function(e){
			   ele.css({left: e.pageX - connector.offsets[id].left, top: e.pageY - connector.offsets[id].top}); //element position = mouse - offset
			  connector.moved(e, ele); // #critical: call the moved() function to update the connector position.
			});
			
			//define mouse up to cancel moving and mouse up, they are recreated each mousedown
			$(document).on('mouseup', function(e){
			  ele.off('mousemove.muConnector');
			  //$(document).off('.muConnector');
			});
			
		});
	}		

});
    </script>


{% endblock %}